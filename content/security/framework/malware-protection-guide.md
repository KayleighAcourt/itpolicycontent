---
title: Malware Protection Guide
---

<table border='1'>
<tr>
<td>This content is a version of the Malware Protection Guide, May 2015.<br/>
This is Legacy IA Policy. It is under review and likely to be withdrawn or substantially revised soon. Please contact us before using this on a new project: <a href="mailto:itpolicycontent@digital.justice.gov.uk?subject=malware-protection-guide">itpolicycontent@digital.justice.gov.uk</a>.</td>
</tr>
</table>

[af]: https://intranet.justice.gov.uk/guidance/security/it-computer-security/infrastructure-system-accreditation/
[aup]: https://intranet.justice.gov.uk/guidance/security/it-computer-security/ict-security-policy-framework/it-acceptable-use-policy/
[iamm]: https://www.ncsc.gov.uk/guidance/information-assurance-maturity-model-and-assessment-framework-gpg-40
[imp]: https://intranet.justice.gov.uk/guidance/security/it-computer-security/ict-security-policy-framework/it-incident-management-policy/
[spf]: https://www.gov.uk/government/publications/security-policy-framework
[tcp]: https://intranet.justice.gov.uk/guidance/security/it-computer-security/ict-security-policy-framework/technical-controls-policy/

## About this document

This document is the MoJ IT Security – Malware Protection Guide. It is designed to help protect MoJ ICT systems by providing guidance on the implementation and use of tools to detect and block malware or malicious content and process for dealing with the malware infection.

### How to use this document

The purpose of this guide is to provide a consistent approach on the application of CESG Good Practice Guide (GPG) No. 7 \[CESG Good Practice Guide No. 7 - Protection from Malicious Code, Issue 1.1, October 2012\]. It does not replace this standard and is designed to be supplementary to it.

The intention of the document is to guide an ICT System Manager or ICT supplier though the aspects which need to be considered to ensure MoJ IT systems are protected against malware.

## Overview

### Introduction

All MoJ ICT systems are under the threat from malware based attacks which have the potential to:

- Compromise the Confidentiality and/or Integrity of MoJ data (which includes sensitive personal data);
- Disrupt the delivery of public service through compromising the Availability of MoJ ICT systems.

The [HMG Security Policy Framework][spf] mandatory requirements 9 states that:

> Departments and Agencies must put in place an appropriate range of technical controls for all ICT systems, proportionate to the value, importance and sensitivity of the information held and the requirements of any interconnected systems.

> To comply with this requirement, Departments and Agencies must:

> Comply with the requirements of any codes of connection, multilateral or bilateral international agreements and community or shared services security policies to which they are signatories (e.g. Government Secure Intranet);

> ... iii) Content checking/blocking policies;

> Ensure that they take action to develop and keep up to date an appropriate understanding of new, emerging and changing threats and vulnerabilities;

The policy on malware protection is covered in [IT Security – Technical Controls Policy][tcp] while this document set outs the MoJ guidance for implementing that policy.

### Scope

This document is intended to provide guidance on the implementation of controls to protect MoJ ICT systems from malware. This document is based on CESG Good Practice Guide (GPG) No. 7 \[CESG Good Practice Guide No. 7 - Protection from Malicious Code, Issue 1.1, October 2012\] and concentrates on providing guidance on the deployment and management of anti-virus and Malware scanning devices and engines in additions to the management of virus/Malware induced IT security incidents.

This guide is not a replacement of CESG GPG No. 7 \[CESG Good Practice Guide No. 7 - Protection from Malicious Code, Issue 1.1, October 2012\] and is designed to supplement it.

### Aim of this guide

The aim of this guide is to ensure all MoJ ICT systems implement adequate security controls to defend against viruses and malware based attacks.

This guide is split up into three sections:

- Understanding the risk – Provides an overview of the types of malware present and the threat posed to an IT system.
- Mitigating security controls – This section provides a high-level view on the different security controls which need to be brought together to provide effective risk mitigation.
- Responding to a malware incident – Provides an overview of what steps should be taken in order to manage a malware incident effectively.

### Demonstration of compliance

The [HMG Information Assurance Maturity Model (IAMM)][iamm] sets out the minimum maturity level Government departments should attain. Provision of anti-malware (anti-virus) services is captured as a basic requirement in Level 1, to which the MoJ will need to demonstrate compliance.

### Further reading

Readers who are using this guide to implement mitigating security control against the risk of malware must read CESG GPG No. 7 \[CESG Good Practice Guide No. 7 - Protection from Malicious Code, Issue 1.1, October 2012\]. In addition, [NIST Special Publication 800-83](https://csrc.nist.gov/publications/detail/sp/800-83/rev-1/final) provides a good reference source.

## Understanding the risk from Malicious Code

CESG GPG No. 7 \[CESG Good Practice Guide No. 7 - Protection from Malicious Code, Issue 1.1, October 2012\], defines malicious code as:

> Malicious code can be considered as any content, data, program, file, application or code that causes a system, application or service to behave in an unexpected, unintended or undesirable way other than that for which it was designed or intended. It can take many forms and can be categorised in a number of different ways.

For the purposes of this guide, all malicious code and viruses will be referred to as malware.

Table 1 provides a list of common malware types along with a description; this is not an exhaustive list but intended to provide a general overview.

| Malware type | Description |
|---|---|
| Virus | Self-replicating software which when activated (for example, upon execution) will then attempt to attach itself to other applications on the system. Viruses can spread via a network or by transfer of the infected media from one system to another system. This type of malware attack, which could possibly be time-delayed, can result in substantial loss of data. |
| Trojans | An application which appears to be legitimate, but includes code which is either detrimental to the operation or to the security of the system on which it is executed. They are different from viruses by their lack of self-replication. The use of Trojans tends to be more directed, either to damage or subvert a particular system or application. |
| Worms | A worm is a piece of malicious code which, unlike a virus, can self replicate. It is typically a self-contained program which can execute itself without any user interactions (e.g. does not require a user to click on an executable file). |
| Malicious macros | Files created in applications which support Visual Basic macros (for example, Microsoft Word and Excel), may contain malicious macros which can be automatically executed when the file is opened. Macros are capable of causing damage ranging from a minor inconvenience, to major damage to a disk's file system. Macros are capable of working across platforms; for example, a file created on an Apple PC may contain a macro which can run, with no modifications, on a Microsoft Windows PC. Antivirus utilities may not be able to detect malicious macros, and as such, other mitigating precautions should also be taken (for example, only allowing digitally signed trusted macros). |
| Malicious mobile code | Active content which can be pushed down via web pages onto the system. The malicious code may either make changes to the file system or the system registry, either taking immediate affect or when the machine is restarted. |

Table 1 – Common Malware types

### Threat and vulnerability

For an IT System to be compromised by a piece of malware (for example, from the common types described in Table 1), that system must be exposed to one or more threat sources and contain one or more vulnerabilities which can be exploited. A threat combined with a vulnerability creates a risk which needs to be managed with an appropriate set of mitigating security controls (see [here](#mitigating-security-controls) for further details).

#### Threat sources

Any mechanism which allows data to be transferred to an IT system is a potential source of malware and poses a threat to that system.

<table border='1'>
<tr>
<th>Threat sources</th>
<th>Description and consideration</th></tr>
<tr>
<td>Internet</td>
<td>The Internet as a threat source is vast with many different methods for infecting an IT system with malware, one common method is
<br/>
Malware infected website: This is where a webpage contains malicious mobile code which is executed by the web browser. A typical example is where a piece of malicious code seeks to exploit a vulnerability in the web browser. The malicious code is embedded within an Active X script which is executed automatically by the browser when a user visits a site containing that script. This could be in the form of a malicious website specifically set up to infect an IT system, or where a site hosts user generated content which allows an attacker to post malicious code on a legitimate website.
<br/>
One of the primary considerations here is that threats from the Internet can attack an IT system at all layers: from network through to application. As such, an assessment of risk and application of mitigating controls must be considered at all levels.</td>
</tr>
<tr>
<td>Media streaming</td>
<td>Media streams are generally encoded data streams which provide a mechanism for malicious code to be embedded within that stream. As the data stream is encoded, common methods for scanning traffic for malicious codes can be circumvented to allow malicious code on an IT system without being detected and executed directly on a user's desktop.</td></tr>
<tr>
<td>Instant messaging</td>
<td>Instant messaging tools range from basic text-based chat utilities, through to complex distributed peer-to-peer communication platforms which cover voice, data and video transfers.
<br/>
In all cases, these tools provide a communication channel to allow embedded malicious code and files to be transmitted onto an IT system. Some tools use custom protocols, encoding and encryption which can circumvent standard web traffic content scanners.</td>
</tr>
<tr>
<td>E-mail</td>
<td>The primary threat concerns malicious code either embedded within an e-mail or attached to it. A typical attack involves some malicious code being attached to an e-mail where the content of the e-mail encourages the user to open the attachment, which in turn executes the code infecting the system. A variant of this type of attack encourages the user to click on a link rather than open an attachment; the link then takes the user to a malicious website.
<br/>
A significant consideration here is that individual users play a very important role as a mitigating security control when provided with appropriate IT security awareness training.</td>
</tr>
<tr>
<td>Connecting devices, equipment and removable media</td>
<td>Any external connection to any other IT systems poses by its very nature an attack vector for malware. This could be a simple as a USB stick used to transfer files from one system to another, through to a Smartphone Bluetooth connection or remote access laptop connection.
<br/>
An example attack is where a Smartphone is used as the transport mechanism to deliver a worm. The worm remains dormant on the Smartphone (which was infected through its 3G connection to the internet). When the Smartphone is connected to the system via a WiFi connection, the worm then transfers itself to that system.
<br/>
The threats posed by each external connection need to be considered. Using the example above, one common issue is that without appropriate mitigating security control, attempts to clean up the worm from the system can be hampered by users re-connecting infected Smartphones.</td>
</tr>
<tr>
<td>Application installation</td>
<td>The installation of an un-trusted application is an easy route into an IT system. Software installation can typically require elevated security privileges which can be exploited by a piece of malware. A significant source of this threat comes from users directly downloading an application from the Internet and installing it onto their workstation. An application could be inherently malicious or it could be a legitimate application which has had malicious code injected into in it.
<br/>
An important consideration here is the ability to verify the integrity of an application prior to its installation (e.g. by using a trusted vendor and/or checking the hash value of an application executable).</td></tr>
</table>

Table 2 – Malware threat sources

#### Vulnerabilities

An IT system can be vulnerable to the threat sources listed in Table 2 due to one or more of the following vulnerabilities:

- Poor system design – Poor architectural design of an IT system can introduce vulnerabilities into that system which on a system level may not be directly executable, however, it provides an open attack vector for malware to attack another part of the system. For example, an architecture without a boundary firewall exposes some internal network services which could be exploited;
- Un-configured or poorly configured hardware or software;
- Applications which have not been developed with secure coding principles;
- IT system operating procedures which are poorly designed and/or not implemented correctly.

<a id='mitigating-security-controls'></a>

## Mitigating security controls

Mitigating security controls covers:

- People – Training and awareness (see [here](#training-and-awareness) );
- Process – Vulnerability and patch management (see [here](#vulnerability-and-patch-management) );
- Technology – Technical controls (see [here](#technical-controls) ).

<a id='training-and-awareness'></a>

### Training and awareness

User training and awareness is vital, as in some cases an individual user could be the last line of defence. A good example of this is an e-mail which contains a link to a malicious website. With appropriate security awareness training, users can be taught how to recognise a malicious e-mail and what they should do in response. In this example, users can be training to look out for e-mails which are not from a trusted sender or where the content of the looks suspicious (e.g. incorrect spelling and grammar).

Typically, the malware protection component of good security training and awareness contains coverage of the following four topics:

- Acceptable Use Policy (AUP) – The MoJ [AUP][aup] has been designed to restrict certain types of e-mail and Internet usages which are know to be common malware threat sources. For example, restricting the use of social media websites as they can host user generated content which contains malicious code.
- E-mail security – To include the identification of malicious e-mail and operating procedures to be followed should a malicious e-mail be discovered;
- Internet security – Covering common techniques on how to identify malicious websites;
- Desktop anti-virus client – This is not so must about the detail of how the anti-virus client operates but the features it provides which a User can make use of (e.g. the ability to run a manual AV scan) and the operating procedures they should follow if the AV client detects a piece of Malware.

<a id='vulnerability-and-patch-management'></a>

### Vulnerability and patch management

Vulnerability and patch management is key mitigating security control. Application vendors release information on security vulnerabilities on regular basis, which needs to be monitored and reviewed with the appropriate mitigating actions taken: for example, the installation of a security patch or amendment to the system's configuration. See [IT Security – Patch Management Standard](https://intranet.justice.gov.uk/guidance/security/it-computer-security/ict-security-policy-framework/patch-management-standard/) for further details.

**Note:** For the application of anti-virus definition/malware signature files, the default time limit is 4 hours from release by the vendor.

<a id='technical-controls'></a>

### Technical controls

Table 3 provides an overview of mitigating security controls, note that this is not an exhaustive list; further guidance is provided in CESG GPG No.7 \[CESG Good Practice Guide No. 7 - Protection from Malicious Code, Issue 1.1, October 2012\].

<table>
<tr>
<th>Mitigating control</th>
<th>Description </th>
</tr>
<tr>
<td>Boundary malware scanning</td>
<td>All external connections must include an AV solution at the boundary to check both incoming and outgoing communications for the presence of malicious code. It is recommended that at least two or more different AV scanning engines are deployed. A boundary malware scanning solution is designed to detect and quarantine malicious files before they have an opportunity to infect the system.</td>
</tr>
<tr>
<td>Boundary content scanning</td>
<td>In addition to a boundary AV solution, all external connection must contain a solution to scan the content of data and its structure.
<br/>Content checkers typically include the following functionality:
<ul>
<li>Quarantining of content that contravenes the agreed rule set;</li>
<li>File-type checks to check whether a file is of an approved file type (e.g. <code>.doc</code> for Microsoft Word) and that it conforms to the standard structure for a file of that type. This is to prevent attacks where a malicious file is given the file extension of an approved file type to circumvent the boundary security controls,</li>
<li>Check for key or dirty words. This can be aligned to the <a href="https://intranet.justice.gov.uk/guidance/security/it-computer-security/ict-security-policy-framework/it-acceptable-use-policy/">IT Security - Acceptable Use Policy</a> to filter content which contravenes that policy.</li>
<li>Check for malicious mobile code (e.g. malicious code embedded within legitimate content which could form part of a cross-site scripting attack).</li>
</ul></td>
</tr>
<tr>
<td>Firewalls </td>
<td>Network-based firewall devices and host-based firewall clients examine network traffic and permit or deny it based on a set of firewall rules.
<br/>A network based firewall device is typically deployed between networks to restrict which types of traffic can pass from one network to another. A host-based firewall is an application run on a single host that can restrict incoming and outgoing network activity for that host only. Enforcing strict controls of which connection and traffic types are permitted restricts the number of attack vectors available and can provide some protection for exposed network services. </td>
</tr>
<tr>
<td>Intrusion Prevention System (IPS) &amp; Intrusion Detection System (IDS)</td>
<td>IPS and IDS devices can either be host based or network based. In general they are designed to monitor system activity on these hosts, and should unusual activity be identified an alert can be generated for analysis and response. An IPS device goes a step further by blocking the suspicious activity identified.
<br/>
It should be considered that the use of intrusion detection and prevention measures could increase the number of 'false positives' detected. This is where legitimate activity is identified as suspicious activity and a subsequent investigation could disrupt the business.</td>
</tr>
<tr>
<td>Operating system configuration</td>
<td>An Operating System (OS) will typically have a number of configurable options and services. Typically, most services will be enabled by default; it is important and standard best practice for all services which are not required to be disabled. Malware typically exploits an open unprotected service as a route into a system to execute an exploit against that service. Locking down the configuration reduces the attack surface available to an attacker (i.e. the number of available service which can be exploited) and allows for other mitigating controls such as a firewall or content scanner to be deployed more effectively.</td>
</tr>
<tr>
<td>Host malware detection client</td>
<td>A host-based malware detection client is designed to scan files on access and the workstations file system periodically or on demand, looking for malicious files. The client should be configured to quarantine any suspicious files identified and to raise an alert. Host AV software is primarily signature-based (although some products have heuristic capability). This means that signature-based AV products are usually only an effective measure against known malicious code attacks. </td>
</tr>
<tr>
<td>'Sheep dip' system</td>
<td>Provide what is effectively a boundary anti-virus check when importing or exporting data using removable media. Sheep dip systems should be standalone and have no network connectivity. A different anti-virus/malware detection engine should be used to that deployed on the system itself. Additionally all new and blank removable media should be scanned on a standalone system before it is introduced to an IT system for either import or export purposes.</td>
</tr>
</table>

Table 3 – Overview of mitigating security controls

### Selection of controls

The selection of mitigating security controls must be within the context of an overall risk assessment. Further information on the risk assessment process can be found in the [Accreditation Framework][af].

### Performance

It is important to consider the 'real-world' implication of implementing any particular mitigating security control. This has particular relevance to some of the security controls mentioned in this guide; for example, content scanners can have an impact on network and application performance.

## Responding to a malware security incident

Responding to a malware incident is part of the overall IT security incident management procedures for an IT system. This section provides particular guidance in relation to responding to a malware related IT security incident, further details on incident management in general can be found in [IT Security – Incident Management Policy][imp].

<table>
<tr>
<th>Malware incident process</th>
<th>Description and consideration</th>
</tr>
<tr>
<td>Preparation</td>
<td>This mostly concerns ensuring that an IT system has undergone a technical risk assessment and any mitigating security controls required have been implemented fully. This includes ensuring all users of the system are appropriately trained in any process and procedures they need to follow.</td>
</tr>
<tr>
<td>Detection and investigation</td>
<td>Detection concerns the ability to detect and validate malware incidents rapidly. Malware infections can spread through an IT system rapidly; early detection can help minimise the size of infection which should lessen the extent of the remediation effort and the amount of damage to the IT system and business processes it supports.
<br/>
Generally, this will consists of three stages:
<ol>
<li>Understanding the signs of the Malware incident<br />
(e.g. a server crashes, AV client detection, or unusual network traffic);</li>
<li>Identifying any malware incident characteristics<br />
(e.g. by comparing observed behaviour with known malware behavioural characteristics information available);</li>
<li>Prioritising the response to the incident.</li>
</ol>
<p>The following pieces of information need to be obtain as part of the investigation in order to effectively prioritise a response:</p>
<ul>
<li>The name and type of malware (e.g. virus or Trojan Horse);</li>
<li>Whether any attack tools have been placed onto the system (indicating that the attack contains multiple phases);</li>
<li>What systems and networks are currently being affected and an assessment of how they are being affected;</li>
<li>A projection of how the impact of malware incident is likely to change over the next few hours and days if the incident is not contained and remediated immediately.</li>
</ul></td>
</tr>
<tr>
<td>Remediation</td>
<td>Essentially this is containment, eradication and recovery in the immediate short term. The investigation in the malware detection is likely to highlight areas in the IT system which may also require immediate remedial action (e.g. application of a security patch or change to an operating systems group policy) to ensure the system is not vulnerable to being re-infected with the same piece of malware.</td>
</tr>
<tr>
<td>Lessons learnt</td>
<td>It is important to critique the response to a malware incident in-order to derive and lessons learnt which can be used to improve the process. In addition, the malware detection investigation may highlight issues in the IT system which will need to be resolved over a longer timescale after the immediate incident has been dealt with.</td>
</tr>
</table>

Table 4 – Malware incident process

### Example response to a malware detection

This section contains a malware detection scenario which is intended to provide an illustration of the detection, investigation and remediation aspects of the malware incident process detailed in Table 4.

#### Detection and investigation

If malware is detected before it can infect the company's systems (i.e. by scanning the incoming removable media) then there is no need for any emergency response. The originator (or IT system owner of the originating system) should be advised of the malware alert and the media destroyed or securely sanitised.

However, if malware is detected on a server or workstation, then the following measures must be taken to stop it spreading:

- All potential malware incidents must be logged as an IT Security incident with the IT Helpdesk (who in turn notify the MoJ Operational Security Team). The server or workstation AV client will automatically log alerts for potential malware to the IT Helpdesk;
- On receipt of a malware incident the IT Helpdesk must immediately investigate whether the suspect malware detection is a positive detection;
- If the detection is on a user workstation, where possible the user of that workstation should be contacted and machine immediately removed from the network;
- If the detection is on a server, where possible, the affected service or application should be suspended;
- The investigation must seek to ascertain the original source of the malware infection.
- All affected (included suspected) machines must be scanned using the latest AV client signatures.

#### Remediation

In most cases the AV client should have successfully quarantined the virus and repaired or deleted any infected files. However, using the outputs from the investigation further remedial action may be required, for example a configuration on a server to disable a vulnerable service where no patch is currently available.

If the malware is found to have propagated through the system, a decision must be made on whether the incident needs to be escalated following the systems Incident Management Plan.